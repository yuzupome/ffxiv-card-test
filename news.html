<script>
document.addEventListener('DOMContentLoaded', () => {
    // --- ここから下が、ページの準備完了後に実行される ---

    const translations = {
        ja: {
            langJa: '日本語',
            langEn: 'English',
            linkJa: '日本語版ジェネレーター',
            linkEn: '英語版ジェネレーター',
            newsTitle: 'Updates',
            update2: '2025.07.26　アイコンカラー変更機能追加 英語版公開',
            update1: '2025.07.05　ジェネレーター公開',
            usageNotes: '利用上の注意'
        },
        en: {
            langJa: '日本語',
            langEn: 'English',
            linkJa: 'Japanese Generator',
            linkEn: 'English Generator',
            newsTitle: 'Updates',
            update2: '2025.07.26 - Added Icon Color feature<br>English version released',
            update1: '2025.07.05 - Generator Released',
            usageNotes: 'Usage Notes'
        }
    };

    const setLanguage = (lang) => {
        document.querySelectorAll('[data-key]').forEach(el => {
            const key = el.dataset.key;
            if (translations[lang] && translations[lang][key]) {
                el.innerHTML = translations[lang][key];
            }
            if (key === 'usageNotes') {
                el.href = (lang === 'en') ? './copyright_en.html' : './copyright.html';
            }
        });
        document.documentElement.lang = lang;
        document.getElementById('lang-ja').classList.toggle('active', lang === 'ja');
        document.getElementById('lang-en').classList.toggle('active', lang === 'en');
    };

    const waitForFooterAndInit = () => {
        const checkInterval = 50;
        const timeout = 5000;
        let elapsedTime = 0;

        const intervalId = setInterval(() => {
            const footerLink = document.querySelector('#footer-placeholder [data-key="usageNotes"]');
            if (footerLink) {
                clearInterval(intervalId);
                setLanguage('ja');
            }
            elapsedTime += checkInterval;
            if (elapsedTime >= timeout) {
                clearInterval(intervalId);
                console.error('フッターの読み込みを待機中にタイムアウトしました。');
            }
        }, checkInterval);
    };

    // ボタンにイベントリスナーを設定
    document.getElementById('lang-ja').addEventListener('click', () => setLanguage('ja'));
    document.getElementById('lang-en').addEventListener('click', () => setLanguage('en'));

    // 初期化処理を開始
    waitForFooterAndInit();

    // --- ここまでが、ページの準備完了後に実行される ---
});
</script>